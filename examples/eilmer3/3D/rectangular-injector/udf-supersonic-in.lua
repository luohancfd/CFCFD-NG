-- udf-supersonic-in.lua
-- Lua script for the user-defined functions 
-- called by the UserDefinedGhostCell BC.
--
-- This particular example is defining the inflow with a turbulent
-- boundary layer profile for inject.py.


function ghost_cell(args)
   -- Function that returns the flow states for a ghost cells.
   -- For use in the inviscid flux calculations.
   --
   -- args contains t, x, y, z, csX, csY, csZ, i, j, k, which_boundary
   -- but we don't happen to us any of them except k.
   --
   prof={}
   prof[1]={z=8.87e-06, p=14786, u=38.7275, v=0, w=-0.00195724, T=3935.35, tke=0.506672, omega=3.38932e+09, f0=0, f1=1}
   prof[2]={z=2.7e-05, p=14785.9, u=117.88, v=0, w=-0.0060686, T=3932.59, tke=14.0035, omega=7.57477e+08, f0=0, f1=1}
   prof[3]={z=4.592e-05, p=14785.4, u=200.539, v=0, w=-0.0115311, T=3924.71, tke=82.3222, omega=2.89339e+08, f0=0, f1=1}
   prof[4]={z=6.567e-05, p=14783.6, u=286.907, v=0, w=-0.0177963, T=3912.04, tke=278.573, omega=1.44144e+08, f0=0, f1=1}
   prof[5]={z=8.628e-05, p=14779.9, u=377.162, v=0, w=-0.0257821, T=3893.9, tke=708.153, omega=8.38392e+07, f0=0, f1=1}
   prof[6]={z=0.00010779, p=14772.7, u=471.421, v=0, w=-0.036018, T=3869.52, tke=1510.73, omega=5.40346e+07, f0=0, f1=1}
   prof[7]={z=0.00013023, p=14760.6, u=569.634, v=0, w=-0.0480957, T=3838.11, tke=2856.29, omega=3.75567e+07, f0=0, f1=1}
   prof[8]={z=0.00015365, p=14741.7, u=671.422, v=0, w=-0.060964, T=3798.92, tke=4925.52, omega=2.77131e+07, f0=0, f1=1}
   prof[9]={z=0.00017808, p=14714.5, u=775.894, v=0, w=-0.0721503, T=3751.4, tke=7864.6, omega=2.14752e+07, f0=0, f1=1}
   prof[10]={z=0.00020357, p=14678, u=881.56, v=0, w=-0.0788665, T=3695.45, tke=11717.2, omega=1.73118e+07, f0=0, f1=1}
   prof[11]={z=0.00023017, p=14633, u=986.465, v=0, w=-0.0777309, T=3631.59, tke=16365.3, omega=1.43863e+07, f0=0, f1=1}
   prof[12]={z=0.00025791, p=14581.3, u=1088.57, v=0, w=-0.0662034, T=3560.96, tke=21527.4, omega=1.22224e+07, f0=0, f1=1}
   prof[13]={z=0.00028685, p=14526.3, u=1186.2, v=0, w=-0.0463218, T=3485.11, tke=26832.3, omega=1.05455e+07, f0=0, f1=1}
   prof[14]={z=0.00031703, p=14471, u=1278.29, v=0, w=-0.018293, T=3405.72, tke=31924.3, omega=9.19745e+06, f0=0, f1=1}
   prof[15]={z=0.0003485, p=14418, u=1364.4, v=0, w=0.015406, T=3324.29, tke=36537.9, omega=8.08587e+06, f0=0, f1=1}
   prof[16]={z=0.00038133, p=14369, u=1444.56, v=0, w=0.0543694, T=3242.03, tke=40520.4, omega=7.15454e+06, f0=0, f1=1}
   prof[17]={z=0.00041556, p=14324.8, u=1519.12, v=0, w=0.0982979, T=3159.81, tke=43814.9, omega=6.36664e+06, f0=0, f1=1}
   prof[18]={z=0.00045124, p=14285.7, u=1588.58, v=0, w=0.147714, T=3078.19, tke=46429.7, omega=5.69606e+06, f0=0, f1=1}
   prof[19]={z=0.00048845, p=14251.7, u=1653.48, v=0, w=0.203391, T=2997.53, tke=48409.9, omega=5.12296e+06, f0=0, f1=1}
   prof[20]={z=0.00052723, p=14222.4, u=1714.37, v=0, w=0.267554, T=2917.98, tke=49816.9, omega=4.63161e+06, f0=0, f1=1}
   prof[21]={z=0.00056766, p=14197.3, u=1771.78, v=0, w=0.334927, T=2839.55, tke=50714.7, omega=4.20913e+06, f0=0, f1=1}
   prof[22]={z=0.00060979, p=14176.9, u=1826.17, v=0, w=0.435137, T=2762.2, tke=51164.3, omega=3.84497e+06, f0=0, f1=1}
   prof[23]={z=0.0006537, p=14160.1, u=1877.97, v=0, w=0.515643, T=2685.78, tke=51217.9, omega=3.53026e+06, f0=0, f1=1}
   prof[24]={z=0.00069945, p=14145.8, u=1927.59, v=0, w=0.648927, T=2610.1, tke=50920, omega=3.25752e+06, f0=0, f1=1}
   prof[25]={z=0.00074711, p=14136, u=1975.34, v=0, w=0.780903, T=2534.97, tke=50306.7, omega=3.02033e+06, f0=0, f1=1}
   prof[26]={z=0.00079676, p=14128.9, u=2021.55, v=0, w=0.948976, T=2460.15, tke=49405.2, omega=2.81328e+06, f0=0, f1=1}
   prof[27]={z=0.00084848, p=14125, u=2066.49, v=0, w=1.1469, T=2385.39, tke=48236.9, omega=2.63188e+06, f0=0, f1=1}
   prof[28]={z=0.00090234, p=14124.2, u=2110.38, v=0, w=1.38516, T=2310.46, tke=46817.2, omega=2.47226e+06, f0=0, f1=1}
   prof[29]={z=0.00095842, p=14126.7, u=2153.45, v=0, w=1.67024, T=2235.08, tke=45156.7, omega=2.33111e+06, f0=0, f1=1}
   prof[30]={z=0.00101681, p=14132.7, u=2195.89, v=0, w=2.01237, T=2159, tke=43262.3, omega=2.20553e+06, f0=0, f1=1}
   prof[31]={z=0.00107759, p=14142.3, u=2237.86, v=0, w=2.42279, T=2081.95, tke=41138.8, omega=2.09292e+06, f0=0, f1=1}
   prof[32]={z=0.00114085, p=14155.9, u=2279.49, v=0, w=2.91488, T=2003.67, tke=38789.5, omega=1.9909e+06, f0=0, f1=1}
   prof[33]={z=0.00120668, p=14174, u=2320.92, v=0, w=3.50401, T=1923.92, tke=36218.1, omega=1.89718e+06, f0=0, f1=1}
   prof[34]={z=0.00127517, p=14196.8, u=2362.21, v=0, w=4.20795, T=1842.44, tke=33430.7, omega=1.80956e+06, f0=0, f1=1}
   prof[35]={z=0.00134642, p=14225, u=2403.43, v=0, w=5.04636, T=1759.03, tke=30437.6, omega=1.72574e+06, f0=0, f1=1}
   prof[36]={z=0.00142052, p=14259.2, u=2444.58, v=0, w=6.04249, T=1673.48, tke=27256.3, omega=1.64334e+06, f0=0, f1=1}
   prof[37]={z=0.00149757, p=14299.5, u=2485.63, v=0, w=7.21318, T=1585.67, tke=23913.2, omega=1.55968e+06, f0=0, f1=1}
   prof[38]={z=0.00157767, p=14347.1, u=2526.47, v=0, w=8.62679, T=1495.52, tke=20445.6, omega=1.47169e+06, f0=0, f1=1}
   prof[39]={z=0.00166093, p=14404.7, u=2567.95, v=0, w=10.4189, T=1400.83, tke=16782.6, omega=1.37164e+06, f0=0, f1=1}
   prof[40]={z=0.00174746, p=14475.7, u=2611.39, v=0, w=12.7282, T=1297.68, tke=12835, omega=1.24799e+06, f0=0, f1=1}
   prof[41]={z=0.00183735, p=14566.8, u=2657.13, v=0, w=15.6609, T=1183.43, tke=8614.64, omega=1.08376e+06, f0=0, f1=1}
   prof[42]={z=0.00193071, p=14689.7, u=2703.5, v=0, w=19.0611, T=1058.63, tke=4473.21, omega=861688, f0=0, f1=1}
   prof[43]={z=0.00202766, p=14766.6, u=2742.8, v=0, w=22.1246, T=937.339, tke=1583.07, omega=617643, f0=0, f1=1}
   prof[44]={z=0.00212832, p=14798.6, u=2765.09, v=0, w=24.9686, T=851.849, tke=412.637, omega=462708, f0=0, f1=1}
   prof[45]={z=0.00223278, p=14816.2, u=2773.56, v=0, w=26.5566, T=811.544, tke=91.7604, omega=408260, f0=0, f1=1}
   prof[46]={z=0.00234116, p=14815.3, u=2776.21, v=0, w=26.8951, T=797.041, tke=21.2617, omega=395518, f0=0, f1=1}
   prof[47]={z=0.00245359, p=14814.7, u=2777.06, v=0, w=26.9584, T=792.231, tke=7.60246, omega=393049, f0=0, f1=1}
   prof[48]={z=0.00257017, p=14813.9, u=2777.42, v=0, w=26.9632, T=790.427, tke=5.13823, omega=392682, f0=0, f1=1}
   prof[49]={z=0.00269103, p=14813.7, u=2777.63, v=0, w=26.9676, T=789.575, tke=4.72665, omega=392692, f0=0, f1=1}
   prof[50]={z=0.00281627, p=14813.7, u=2777.79, v=0, w=26.9772, T=789.053, tke=4.66819, omega=392791, f0=0, f1=1}
   prof[51]={z=0.00294601, p=14813.9, u=2777.93, v=0, w=26.9907, T=788.667, tke=4.66528, omega=392900, f0=0, f1=1}
   prof[52]={z=0.00308037, p=14814.1, u=2778.04, v=0, w=27.0008, T=788.352, tke=4.67023, omega=392997, f0=0, f1=1}
   prof[53]={z=0.00321947, p=14813.9, u=2778.12, v=0, w=27.0027, T=788.088, tke=4.67571, omega=393092, f0=0, f1=1}
   prof[54]={z=0.0033634, p=14813.7, u=2778.19, v=0, w=27.0001, T=787.875, tke=4.67976, omega=393189, f0=0, f1=1}
   prof[55]={z=0.0035123, p=14813.3, u=2778.25, v=0, w=26.988, T=787.698, tke=4.6832, omega=393285, f0=0, f1=1}
   prof[56]={z=0.00366626, p=14812.5, u=2778.3, v=0, w=26.9683, T=787.538, tke=4.68618, omega=393380, f0=0, f1=1}
   prof[57]={z=0.00382539, p=14811.9, u=2778.35, v=0, w=26.9524, T=787.383, tke=4.68867, omega=393475, f0=0, f1=1}
   prof[58]={z=0.0039898, p=14811.4, u=2778.41, v=0, w=26.9429, T=787.221, tke=4.69126, omega=393592, f0=0, f1=1}
   prof[59]={z=0.00415959, p=14810.9, u=2778.47, v=0, w=26.9369, T=787.074, tke=4.69302, omega=393689, f0=0, f1=1}
   prof[60]={z=0.00433484, p=14810.4, u=2778.49, v=0, w=26.9279, T=787.004, tke=4.69442, omega=393765, f0=0, f1=1}
   prof[61]={z=0.00451566, p=14809.7, u=2778.5, v=0, w=26.9138, T=786.969, tke=4.69688, omega=393875, f0=0, f1=1}
   prof[62]={z=0.00470213, p=14808.8, u=2778.51, v=0, w=26.8959, T=786.925, tke=4.69842, omega=393973, f0=0, f1=1}
   prof[63]={z=0.00489433, p=14807.7, u=2778.53, v=0, w=26.8767, T=786.835, tke=4.69942, omega=394069, f0=0, f1=1}
   prof[64]={z=0.00509234, p=14806.9, u=2778.59, v=0, w=26.8441, T=786.674, tke=4.7003, omega=394172, f0=0, f1=1}
   prof[65]={z=0.00529621, p=14805.5, u=2778.68, v=0, w=26.8173, T=786.473, tke=4.70106, omega=394274, f0=0, f1=1}
   prof[66]={z=0.00550602, p=14804.1, u=2778.78, v=0, w=26.7835, T=786.275, tke=4.70216, omega=394380, f0=0, f1=1}
   prof[67]={z=0.00572181, p=14802.7, u=2778.84, v=0, w=26.7442, T=786.149, tke=4.70368, omega=394484, f0=0, f1=1}
   prof[68]={z=0.00594362, p=14801.3, u=2778.85, v=0, w=26.6935, T=786.059, tke=4.70587, omega=394600, f0=0, f1=1}
   prof[69]={z=0.00617149, p=14800, u=2778.86, v=0, w=26.6385, T=785.998, tke=4.70787, omega=394715, f0=0, f1=1}
   prof[70]={z=0.00640544, p=14799, u=2778.86, v=0, w=26.5641, T=785.947, tke=4.70985, omega=394838, f0=0, f1=1}
   prof[71]={z=0.00664547, p=14797.7, u=2778.89, v=0, w=26.4757, T=785.882, tke=4.71217, omega=394975, f0=0, f1=1}
   prof[72]={z=0.00689161, p=14794, u=2778.95, v=0, w=26.421, T=785.754, tke=4.71394, omega=395093, f0=0, f1=1}
   prof[73]={z=0.00714381, p=14788.2, u=2779, v=0, w=26.4192, T=785.611, tke=4.71519, omega=395191, f0=0, f1=1}
   prof[74]={z=0.00740208, p=14779.9, u=2779.06, v=0, w=26.4528, T=785.427, tke=4.7155, omega=395262, f0=0, f1=1}
   prof[75]={z=0.00766636, p=14768.3, u=2779.12, v=0, w=26.5595, T=785.228, tke=4.71519, omega=395309, f0=0, f1=1}
   prof[76]={z=0.00793661, p=14750.3, u=2779.23, v=0, w=26.8146, T=784.918, tke=4.71438, omega=395337, f0=0, f1=1}
   prof[77]={z=0.00821276, p=14723.2, u=2779.38, v=0, w=27.3039, T=784.47, tke=4.71256, omega=395313, f0=0, f1=1}
   prof[78]={z=0.00849473, p=14680.7, u=2779.63, v=0, w=28.1915, T=783.766, tke=4.70824, omega=395180, f0=0, f1=1}
   prof[79]={z=0.00878242, p=14615.1, u=2780, v=0, w=29.6808, T=782.719, tke=4.70071, omega=394910, f0=0, f1=1}
   prof[80]={z=0.00907573, p=14523.1, u=2780.51, v=0, w=31.8664, T=781.251, tke=4.68959, omega=394490, f0=0, f1=1}
   prof[81]={z=0.00937454, p=14419, u=2781.09, v=0, w=34.396, T=779.614, tke=4.67717, omega=394018, f0=0, f1=1}
   prof[82]={z=0.00967869, p=14331.3, u=2781.57, v=0, w=36.3611, T=778.226, tke=4.6673, omega=393658, f0=0, f1=1}
   prof[83]={z=0.00998804, p=14285.2, u=2781.84, v=0, w=37.497, T=777.483, tke=4.66262, omega=393525, f0=0, f1=1}
   prof[84]={z=0.0103024, p=14251.5, u=2782.03, v=0, w=37.6244, T=776.938, tke=4.66029, omega=393500, f0=0, f1=1}
   prof[85]={z=0.0106216, p=14241.2, u=2782.1, v=0, w=37.4992, T=776.762, tke=4.66152, omega=393625, f0=0, f1=1}
   prof[86]={z=0.0109454, p=14244.7, u=2782.1, v=0, w=37.1919, T=776.778, tke=4.66472, omega=393846, f0=0, f1=1}
   prof[87]={z=0.0112737, p=14265.2, u=2781.99, v=0, w=36.3571, T=777.092, tke=4.67151, omega=394219, f0=0, f1=1}
   prof[88]={z=0.0116061, p=14310.9, u=2781.76, v=0, w=34.8806, T=777.757, tke=4.68141, omega=394732, f0=0, f1=1}
   prof[89]={z=0.0119425, p=14352.3, u=2781.55, v=0, w=33.7055, T=778.363, tke=4.69084, omega=395217, f0=0, f1=1}
   prof[90]={z=0.0122825, p=14384.4, u=2781.38, v=0, w=32.9057, T=778.829, tke=4.69841, omega=395625, f0=0, f1=1}
   prof[91]={z=0.012626, p=14408.5, u=2781.25, v=0, w=32.3253, T=779.197, tke=4.70545, omega=396002, f0=0, f1=1}
   prof[92]={z=0.0129725, p=14428.6, u=2781.14, v=0, w=32.008, T=779.457, tke=4.7117, omega=396350, f0=0, f1=1}
   prof[93]={z=0.0133219, p=14458.7, u=2781, v=0, w=31.9707, T=779.916, tke=4.71851, omega=396716, f0=0, f1=1}
   prof[94]={z=0.0136738, p=14480.9, u=2780.85, v=0, w=32.1735, T=780.21, tke=4.72525, omega=397082, f0=0, f1=1}
   prof[95]={z=0.0140279, p=14510, u=2780.71, v=0, w=32.4712, T=780.662, tke=4.73306, omega=397495, f0=0, f1=1}
   prof[96]={z=0.0143839, p=14547.3, u=2780.51, v=0, w=32.7924, T=781.227, tke=4.74137, omega=397929, f0=0, f1=1}
   prof[97]={z=0.0147414, p=14582.7, u=2780.29, v=0, w=33.2649, T=781.782, tke=4.74893, omega=398332, f0=0, f1=1}
   prof[98]={z=0.0151002, p=14622.3, u=2779.99, v=0, w=33.9357, T=782.428, tke=4.76877, omega=399255, f0=0, f1=1}
   prof[99]={z=0.0154597, p=14659.1, u=2779.88, v=0, w=34.4416, T=782.73, tke=4.76456, omega=399136, f0=0, f1=1}
   prof[100]={z=0.0158199, p=14725.9, u=2779.51, v=0, w=35.6921, T=783.753, tke=4.78572, omega=400197, f0=0, f1=1}
   ghost = {}
   ghost.p = prof[args.k-1].p-- pressure, Pa
   ghost.T = {}  -- temperatures, K (as a table)
   ghost.T[0] = prof[args.k-1].T
   ghost.u = prof[args.k-1].u  -- x-velocity, m/s
   ghost.v = prof[args.k-1].v     -- y-velocity, m/s
   ghost.w = prof[args.k-1].w
   ghost.tke = prof[args.k-1].tke
   ghost.omega = prof[args.k-1].omega
   ghost.massf = {} -- mass fractions to be provided as a table
   ghost.massf[0] = prof[args.k-1].f0 -- mass fractions are indexed from 0 to nsp-1
   ghost.massf[1] = prof[args.k-1].f1 -- mass fractions are indexed from 0 to nsp-1
   return ghost, ghost
end


function interface(args)
   -- Function that returns the conditions at the boundary 
   -- when viscous terms are active.
   --
   -- args contains t, x, y, z, csX, csY, csZ, i, j, k, which_boundary
   -- but we don't happen to us any of them except k
   prof={}
   prof[1]={z=8.87e-06, p=14786, u=38.7275, v=0, w=-0.00195724, T=3935.35, tke=0.506672, omega=3.38932e+09, f0=0, f1=1}
   prof[2]={z=2.7e-05, p=14785.9, u=117.88, v=0, w=-0.0060686, T=3932.59, tke=14.0035, omega=7.57477e+08, f0=0, f1=1}
   prof[3]={z=4.592e-05, p=14785.4, u=200.539, v=0, w=-0.0115311, T=3924.71, tke=82.3222, omega=2.89339e+08, f0=0, f1=1}
   prof[4]={z=6.567e-05, p=14783.6, u=286.907, v=0, w=-0.0177963, T=3912.04, tke=278.573, omega=1.44144e+08, f0=0, f1=1}
   prof[5]={z=8.628e-05, p=14779.9, u=377.162, v=0, w=-0.0257821, T=3893.9, tke=708.153, omega=8.38392e+07, f0=0, f1=1}
   prof[6]={z=0.00010779, p=14772.7, u=471.421, v=0, w=-0.036018, T=3869.52, tke=1510.73, omega=5.40346e+07, f0=0, f1=1}
   prof[7]={z=0.00013023, p=14760.6, u=569.634, v=0, w=-0.0480957, T=3838.11, tke=2856.29, omega=3.75567e+07, f0=0, f1=1}
   prof[8]={z=0.00015365, p=14741.7, u=671.422, v=0, w=-0.060964, T=3798.92, tke=4925.52, omega=2.77131e+07, f0=0, f1=1}
   prof[9]={z=0.00017808, p=14714.5, u=775.894, v=0, w=-0.0721503, T=3751.4, tke=7864.6, omega=2.14752e+07, f0=0, f1=1}
   prof[10]={z=0.00020357, p=14678, u=881.56, v=0, w=-0.0788665, T=3695.45, tke=11717.2, omega=1.73118e+07, f0=0, f1=1}
   prof[11]={z=0.00023017, p=14633, u=986.465, v=0, w=-0.0777309, T=3631.59, tke=16365.3, omega=1.43863e+07, f0=0, f1=1}
   prof[12]={z=0.00025791, p=14581.3, u=1088.57, v=0, w=-0.0662034, T=3560.96, tke=21527.4, omega=1.22224e+07, f0=0, f1=1}
   prof[13]={z=0.00028685, p=14526.3, u=1186.2, v=0, w=-0.0463218, T=3485.11, tke=26832.3, omega=1.05455e+07, f0=0, f1=1}
   prof[14]={z=0.00031703, p=14471, u=1278.29, v=0, w=-0.018293, T=3405.72, tke=31924.3, omega=9.19745e+06, f0=0, f1=1}
   prof[15]={z=0.0003485, p=14418, u=1364.4, v=0, w=0.015406, T=3324.29, tke=36537.9, omega=8.08587e+06, f0=0, f1=1}
   prof[16]={z=0.00038133, p=14369, u=1444.56, v=0, w=0.0543694, T=3242.03, tke=40520.4, omega=7.15454e+06, f0=0, f1=1}
   prof[17]={z=0.00041556, p=14324.8, u=1519.12, v=0, w=0.0982979, T=3159.81, tke=43814.9, omega=6.36664e+06, f0=0, f1=1}
   prof[18]={z=0.00045124, p=14285.7, u=1588.58, v=0, w=0.147714, T=3078.19, tke=46429.7, omega=5.69606e+06, f0=0, f1=1}
   prof[19]={z=0.00048845, p=14251.7, u=1653.48, v=0, w=0.203391, T=2997.53, tke=48409.9, omega=5.12296e+06, f0=0, f1=1}
   prof[20]={z=0.00052723, p=14222.4, u=1714.37, v=0, w=0.267554, T=2917.98, tke=49816.9, omega=4.63161e+06, f0=0, f1=1}
   prof[21]={z=0.00056766, p=14197.3, u=1771.78, v=0, w=0.334927, T=2839.55, tke=50714.7, omega=4.20913e+06, f0=0, f1=1}
   prof[22]={z=0.00060979, p=14176.9, u=1826.17, v=0, w=0.435137, T=2762.2, tke=51164.3, omega=3.84497e+06, f0=0, f1=1}
   prof[23]={z=0.0006537, p=14160.1, u=1877.97, v=0, w=0.515643, T=2685.78, tke=51217.9, omega=3.53026e+06, f0=0, f1=1}
   prof[24]={z=0.00069945, p=14145.8, u=1927.59, v=0, w=0.648927, T=2610.1, tke=50920, omega=3.25752e+06, f0=0, f1=1}
   prof[25]={z=0.00074711, p=14136, u=1975.34, v=0, w=0.780903, T=2534.97, tke=50306.7, omega=3.02033e+06, f0=0, f1=1}
   prof[26]={z=0.00079676, p=14128.9, u=2021.55, v=0, w=0.948976, T=2460.15, tke=49405.2, omega=2.81328e+06, f0=0, f1=1}
   prof[27]={z=0.00084848, p=14125, u=2066.49, v=0, w=1.1469, T=2385.39, tke=48236.9, omega=2.63188e+06, f0=0, f1=1}
   prof[28]={z=0.00090234, p=14124.2, u=2110.38, v=0, w=1.38516, T=2310.46, tke=46817.2, omega=2.47226e+06, f0=0, f1=1}
   prof[29]={z=0.00095842, p=14126.7, u=2153.45, v=0, w=1.67024, T=2235.08, tke=45156.7, omega=2.33111e+06, f0=0, f1=1}
   prof[30]={z=0.00101681, p=14132.7, u=2195.89, v=0, w=2.01237, T=2159, tke=43262.3, omega=2.20553e+06, f0=0, f1=1}
   prof[31]={z=0.00107759, p=14142.3, u=2237.86, v=0, w=2.42279, T=2081.95, tke=41138.8, omega=2.09292e+06, f0=0, f1=1}
   prof[32]={z=0.00114085, p=14155.9, u=2279.49, v=0, w=2.91488, T=2003.67, tke=38789.5, omega=1.9909e+06, f0=0, f1=1}
   prof[33]={z=0.00120668, p=14174, u=2320.92, v=0, w=3.50401, T=1923.92, tke=36218.1, omega=1.89718e+06, f0=0, f1=1}
   prof[34]={z=0.00127517, p=14196.8, u=2362.21, v=0, w=4.20795, T=1842.44, tke=33430.7, omega=1.80956e+06, f0=0, f1=1}
   prof[35]={z=0.00134642, p=14225, u=2403.43, v=0, w=5.04636, T=1759.03, tke=30437.6, omega=1.72574e+06, f0=0, f1=1}
   prof[36]={z=0.00142052, p=14259.2, u=2444.58, v=0, w=6.04249, T=1673.48, tke=27256.3, omega=1.64334e+06, f0=0, f1=1}
   prof[37]={z=0.00149757, p=14299.5, u=2485.63, v=0, w=7.21318, T=1585.67, tke=23913.2, omega=1.55968e+06, f0=0, f1=1}
   prof[38]={z=0.00157767, p=14347.1, u=2526.47, v=0, w=8.62679, T=1495.52, tke=20445.6, omega=1.47169e+06, f0=0, f1=1}
   prof[39]={z=0.00166093, p=14404.7, u=2567.95, v=0, w=10.4189, T=1400.83, tke=16782.6, omega=1.37164e+06, f0=0, f1=1}
   prof[40]={z=0.00174746, p=14475.7, u=2611.39, v=0, w=12.7282, T=1297.68, tke=12835, omega=1.24799e+06, f0=0, f1=1}
   prof[41]={z=0.00183735, p=14566.8, u=2657.13, v=0, w=15.6609, T=1183.43, tke=8614.64, omega=1.08376e+06, f0=0, f1=1}
   prof[42]={z=0.00193071, p=14689.7, u=2703.5, v=0, w=19.0611, T=1058.63, tke=4473.21, omega=861688, f0=0, f1=1}
   prof[43]={z=0.00202766, p=14766.6, u=2742.8, v=0, w=22.1246, T=937.339, tke=1583.07, omega=617643, f0=0, f1=1}
   prof[44]={z=0.00212832, p=14798.6, u=2765.09, v=0, w=24.9686, T=851.849, tke=412.637, omega=462708, f0=0, f1=1}
   prof[45]={z=0.00223278, p=14816.2, u=2773.56, v=0, w=26.5566, T=811.544, tke=91.7604, omega=408260, f0=0, f1=1}
   prof[46]={z=0.00234116, p=14815.3, u=2776.21, v=0, w=26.8951, T=797.041, tke=21.2617, omega=395518, f0=0, f1=1}
   prof[47]={z=0.00245359, p=14814.7, u=2777.06, v=0, w=26.9584, T=792.231, tke=7.60246, omega=393049, f0=0, f1=1}
   prof[48]={z=0.00257017, p=14813.9, u=2777.42, v=0, w=26.9632, T=790.427, tke=5.13823, omega=392682, f0=0, f1=1}
   prof[49]={z=0.00269103, p=14813.7, u=2777.63, v=0, w=26.9676, T=789.575, tke=4.72665, omega=392692, f0=0, f1=1}
   prof[50]={z=0.00281627, p=14813.7, u=2777.79, v=0, w=26.9772, T=789.053, tke=4.66819, omega=392791, f0=0, f1=1}
   prof[51]={z=0.00294601, p=14813.9, u=2777.93, v=0, w=26.9907, T=788.667, tke=4.66528, omega=392900, f0=0, f1=1}
   prof[52]={z=0.00308037, p=14814.1, u=2778.04, v=0, w=27.0008, T=788.352, tke=4.67023, omega=392997, f0=0, f1=1}
   prof[53]={z=0.00321947, p=14813.9, u=2778.12, v=0, w=27.0027, T=788.088, tke=4.67571, omega=393092, f0=0, f1=1}
   prof[54]={z=0.0033634, p=14813.7, u=2778.19, v=0, w=27.0001, T=787.875, tke=4.67976, omega=393189, f0=0, f1=1}
   prof[55]={z=0.0035123, p=14813.3, u=2778.25, v=0, w=26.988, T=787.698, tke=4.6832, omega=393285, f0=0, f1=1}
   prof[56]={z=0.00366626, p=14812.5, u=2778.3, v=0, w=26.9683, T=787.538, tke=4.68618, omega=393380, f0=0, f1=1}
   prof[57]={z=0.00382539, p=14811.9, u=2778.35, v=0, w=26.9524, T=787.383, tke=4.68867, omega=393475, f0=0, f1=1}
   prof[58]={z=0.0039898, p=14811.4, u=2778.41, v=0, w=26.9429, T=787.221, tke=4.69126, omega=393592, f0=0, f1=1}
   prof[59]={z=0.00415959, p=14810.9, u=2778.47, v=0, w=26.9369, T=787.074, tke=4.69302, omega=393689, f0=0, f1=1}
   prof[60]={z=0.00433484, p=14810.4, u=2778.49, v=0, w=26.9279, T=787.004, tke=4.69442, omega=393765, f0=0, f1=1}
   prof[61]={z=0.00451566, p=14809.7, u=2778.5, v=0, w=26.9138, T=786.969, tke=4.69688, omega=393875, f0=0, f1=1}
   prof[62]={z=0.00470213, p=14808.8, u=2778.51, v=0, w=26.8959, T=786.925, tke=4.69842, omega=393973, f0=0, f1=1}
   prof[63]={z=0.00489433, p=14807.7, u=2778.53, v=0, w=26.8767, T=786.835, tke=4.69942, omega=394069, f0=0, f1=1}
   prof[64]={z=0.00509234, p=14806.9, u=2778.59, v=0, w=26.8441, T=786.674, tke=4.7003, omega=394172, f0=0, f1=1}
   prof[65]={z=0.00529621, p=14805.5, u=2778.68, v=0, w=26.8173, T=786.473, tke=4.70106, omega=394274, f0=0, f1=1}
   prof[66]={z=0.00550602, p=14804.1, u=2778.78, v=0, w=26.7835, T=786.275, tke=4.70216, omega=394380, f0=0, f1=1}
   prof[67]={z=0.00572181, p=14802.7, u=2778.84, v=0, w=26.7442, T=786.149, tke=4.70368, omega=394484, f0=0, f1=1}
   prof[68]={z=0.00594362, p=14801.3, u=2778.85, v=0, w=26.6935, T=786.059, tke=4.70587, omega=394600, f0=0, f1=1}
   prof[69]={z=0.00617149, p=14800, u=2778.86, v=0, w=26.6385, T=785.998, tke=4.70787, omega=394715, f0=0, f1=1}
   prof[70]={z=0.00640544, p=14799, u=2778.86, v=0, w=26.5641, T=785.947, tke=4.70985, omega=394838, f0=0, f1=1}
   prof[71]={z=0.00664547, p=14797.7, u=2778.89, v=0, w=26.4757, T=785.882, tke=4.71217, omega=394975, f0=0, f1=1}
   prof[72]={z=0.00689161, p=14794, u=2778.95, v=0, w=26.421, T=785.754, tke=4.71394, omega=395093, f0=0, f1=1}
   prof[73]={z=0.00714381, p=14788.2, u=2779, v=0, w=26.4192, T=785.611, tke=4.71519, omega=395191, f0=0, f1=1}
   prof[74]={z=0.00740208, p=14779.9, u=2779.06, v=0, w=26.4528, T=785.427, tke=4.7155, omega=395262, f0=0, f1=1}
   prof[75]={z=0.00766636, p=14768.3, u=2779.12, v=0, w=26.5595, T=785.228, tke=4.71519, omega=395309, f0=0, f1=1}
   prof[76]={z=0.00793661, p=14750.3, u=2779.23, v=0, w=26.8146, T=784.918, tke=4.71438, omega=395337, f0=0, f1=1}
   prof[77]={z=0.00821276, p=14723.2, u=2779.38, v=0, w=27.3039, T=784.47, tke=4.71256, omega=395313, f0=0, f1=1}
   prof[78]={z=0.00849473, p=14680.7, u=2779.63, v=0, w=28.1915, T=783.766, tke=4.70824, omega=395180, f0=0, f1=1}
   prof[79]={z=0.00878242, p=14615.1, u=2780, v=0, w=29.6808, T=782.719, tke=4.70071, omega=394910, f0=0, f1=1}
   prof[80]={z=0.00907573, p=14523.1, u=2780.51, v=0, w=31.8664, T=781.251, tke=4.68959, omega=394490, f0=0, f1=1}
   prof[81]={z=0.00937454, p=14419, u=2781.09, v=0, w=34.396, T=779.614, tke=4.67717, omega=394018, f0=0, f1=1}
   prof[82]={z=0.00967869, p=14331.3, u=2781.57, v=0, w=36.3611, T=778.226, tke=4.6673, omega=393658, f0=0, f1=1}
   prof[83]={z=0.00998804, p=14285.2, u=2781.84, v=0, w=37.497, T=777.483, tke=4.66262, omega=393525, f0=0, f1=1}
   prof[84]={z=0.0103024, p=14251.5, u=2782.03, v=0, w=37.6244, T=776.938, tke=4.66029, omega=393500, f0=0, f1=1}
   prof[85]={z=0.0106216, p=14241.2, u=2782.1, v=0, w=37.4992, T=776.762, tke=4.66152, omega=393625, f0=0, f1=1}
   prof[86]={z=0.0109454, p=14244.7, u=2782.1, v=0, w=37.1919, T=776.778, tke=4.66472, omega=393846, f0=0, f1=1}
   prof[87]={z=0.0112737, p=14265.2, u=2781.99, v=0, w=36.3571, T=777.092, tke=4.67151, omega=394219, f0=0, f1=1}
   prof[88]={z=0.0116061, p=14310.9, u=2781.76, v=0, w=34.8806, T=777.757, tke=4.68141, omega=394732, f0=0, f1=1}
   prof[89]={z=0.0119425, p=14352.3, u=2781.55, v=0, w=33.7055, T=778.363, tke=4.69084, omega=395217, f0=0, f1=1}
   prof[90]={z=0.0122825, p=14384.4, u=2781.38, v=0, w=32.9057, T=778.829, tke=4.69841, omega=395625, f0=0, f1=1}
   prof[91]={z=0.012626, p=14408.5, u=2781.25, v=0, w=32.3253, T=779.197, tke=4.70545, omega=396002, f0=0, f1=1}
   prof[92]={z=0.0129725, p=14428.6, u=2781.14, v=0, w=32.008, T=779.457, tke=4.7117, omega=396350, f0=0, f1=1}
   prof[93]={z=0.0133219, p=14458.7, u=2781, v=0, w=31.9707, T=779.916, tke=4.71851, omega=396716, f0=0, f1=1}
   prof[94]={z=0.0136738, p=14480.9, u=2780.85, v=0, w=32.1735, T=780.21, tke=4.72525, omega=397082, f0=0, f1=1}
   prof[95]={z=0.0140279, p=14510, u=2780.71, v=0, w=32.4712, T=780.662, tke=4.73306, omega=397495, f0=0, f1=1}
   prof[96]={z=0.0143839, p=14547.3, u=2780.51, v=0, w=32.7924, T=781.227, tke=4.74137, omega=397929, f0=0, f1=1}
   prof[97]={z=0.0147414, p=14582.7, u=2780.29, v=0, w=33.2649, T=781.782, tke=4.74893, omega=398332, f0=0, f1=1}
   prof[98]={z=0.0151002, p=14622.3, u=2779.99, v=0, w=33.9357, T=782.428, tke=4.76877, omega=399255, f0=0, f1=1}
   prof[99]={z=0.0154597, p=14659.1, u=2779.88, v=0, w=34.4416, T=782.73, tke=4.76456, omega=399136, f0=0, f1=1}
   prof[100]={z=0.0158199, p=14725.9, u=2779.51, v=0, w=35.6921, T=783.753, tke=4.78572, omega=400197, f0=0, f1=1}
   wall = {}
   wall.u = prof[args.k-1].u
   wall.v = prof[args.k-1].v
   wall.w = prof[args.k-1].w
   wall.T = {prof[args.k-1].T,} -- now a table, PJ, 15-Apr-2012
   wall.tke = prof[args.k-1].tke
   wall.omega = prof[args.k-1].omega
   wall.massf = {}
   wall.massf[0] = prof[args.k-1].f0
   wall.massf[1] = prof[args.k-1].f1
   return wall
end
