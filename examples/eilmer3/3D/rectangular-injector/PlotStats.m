%% PlotStats.m
%
% Picks up the file generated by mix_and_vort.py and plots the results
%
% Vincent Wheatley 12.05.2010

% Parameters for non-dimensionalization
D = 2.0*sqrt(1.0e-6/pi); 	% m, 	Effective diameter of port
U = 2780;		% m/s,	Freesteam velocity
L1i = 4.0e-3;		% m,	Length to injector leading edge - inviscid cases
L1v = 1.0e-2;		% m,	Length to injector leading edge - viscous cases

%% Open files
%
% Import the file, numerical data content is stored in newData1.data.
newData1 = importdata('mixvort.dat');
x6    	= newData1.data(:,1)/D-L1v/D;
Fq6 	= newData1.data(:,2);
Fhtot6 	= newData1.data(:,3);
mf6	= newData1.data(:,4);
mfR6 	= newData1.data(:,5);
prec6 	= newData1.data(:,6);
zpen6	= newData1.data(:,7)/D;
circ6	= newData1.data(:,8)/(U*D);
clear newData1;

%% INVISCID RESULTS
%
% Plot mixedness
xlim = [-5 28];
alim_circ_i = [xlim 0 2.5];
alim_circ_v = [xlim 0 8];
alim_prec = [xlim 0 0.09];
alim_etam_i = [xlim 0 0.09];
alim_etam_v = [xlim 0 0.15];
alim_zpen = [xlim 0 6.5];
vblue=[0 191/256 191/256];
vgreen=[0 127/256 0];

%% VISCOUS RESULTS
%
figure(1)
H1 = plot(x6,circ6,'-');
for i=1:length(H1)
    set(H1(i),'LineWidth',2);
    if i<=length(H1)/2 
       set(H1(i),'Color',vgreen); 
    else
       set(H1(i),'Color',vblue); 
    end
end
ht = xlabel('streamwise distance, {\it x/D}');
set(ht,'FontSize',14);
ht = ylabel('absolute streamwise circulation, {\it\Gamma_x/UD}');
set(ht,'FontSize',14);
ht = legend('16:1 rectangle - viscous','Location','NorthEast');
set(ht,'FontSize',14);
legend boxoff
axis(alim_circ_v);

% Plot penetration
figure(2)
H1 = plot(x6,zpen6,'-');
for i=1:length(H1)
    set(H1(i),'LineWidth',2);
    if i<=length(H1)/2 
       set(H1(i),'Color',vgreen); 
    else
       set(H1(i),'Color',vblue); 
    end
end
ht = xlabel('streamwise distance, {\it x/D}');
set(ht,'FontSize',14);
ht = ylabel('jet penetration, {\it P}');
set(ht,'FontSize',14);
ht = legend('16:1 rectangle - viscous','Location','SouthEast');
set(ht,'FontSize',14);
legend boxoff
axis(alim_zpen);

% Plot reactable H2
figure(3)
H1 = plot(x6,mfR6/mf6(end),'-');
for i=1:length(H1)
    set(H1(i),'LineWidth',2);
    if i<=length(H1)/2 
       set(H1(i),'Color',vgreen); 
    else
       set(H1(i),'Color',vblue); 
    end
end
ht = xlabel('streamwise distance, {\it x/D}');
set(ht,'FontSize',14);
ht = ylabel('mixing efficiency, {\it\eta_m}');
set(ht,'FontSize',14);
ht = legend('16:1 rectangle - viscous','Location','SouthEast');
set(ht,'FontSize',14);
legend boxoff
axis(alim_etam_v);

% Plot pressure recovery
figure(4)
H1 = plot(x6,1-prec6/prec6(1),'-');
for i=1:length(H1)
    set(H1(i),'LineWidth',2);
    if i<=length(H1)/2 
       set(H1(i),'Color',vgreen); 
    else
       set(H1(i),'Color',vblue); 
    end
end
ht = xlabel('streamwise distance, {\it x/D}');
set(ht,'FontSize',14);
ht = ylabel('Stagnation pressure loss, {\it\Pi}');
set(ht,'FontSize',14);
ht = legend('16:1 rectangle - viscous','Location','SouthEast');
set(ht,'FontSize',14);
legend boxoff
axis(alim_prec);

