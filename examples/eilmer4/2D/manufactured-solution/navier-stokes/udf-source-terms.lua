-- udf-source-template.lua
-- Lua template for the source terms of a Manufactured Solution.
--
-- PJ, 29-May-2011
-- RJG, 06-Jun-2014
--   Declared maths functions as local

local sin = math.sin
local cos = math.cos
local exp = math.exp
local pi = math.pi

function sourceTerms(t, cell)
   src = {}
   x = cell.x
   y = cell.y


fmass = (9.9*pi*x*sin(2.82743338823081*x*y) + 4.0*pi*cos(3.14159265358979*y))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0) + (-0.1*pi*x*sin(3.92699081698724*x*y) - 0.15*pi*sin(3.14159265358979*y))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) +90.0) + (-4.2*pi*y*sin(1.88495559215388*x*y) +6.66666666666667*pi*cos(5.23598775598299*x))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0) + (-0.1*pi*y*sin(3.92699081698724*x*y) + 0.075*pi*cos(2.35619449019234*x))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0)



fxmom = 25.2*pi^2*x^2*cos(1.88495559215388*x*y) - 29.7*pi^2*x*y*cos(2.82743338823081*x*y) + 33.6*pi^2*y^2*cos(1.88495559215388*x*y) - 18750.0*pi*y*cos(2.35619449019234*x*y) + (-4.2*pi*x*sin(1.88495559215388*x*y) + 18.0*pi*sin(4.71238898038469*y))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) +90.0) + (9.9*pi*x*sin(2.82743338823081*x*y) + 4.0*pi*cos(3.14159265358979*y))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0) + (-0.1*pi*x*sin(3.92699081698724*x*y) - 0.15*pi*sin(3.14159265358979*y))*(4.0*sin(5.23598775598299*x) -12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) +90.0) + (-8.4*pi*y*sin(1.88495559215388*x*y) +13.3333333333333*pi*cos(5.23598775598299*x))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0) + (-0.1*pi*y*sin(3.92699081698724*x*y) + 0.075*pi*cos(2.35619449019234*x))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0)^2 + 30000.0*pi*sin(3.14159265358979*x) + 148.148148148148*pi^2*sin(5.23598775598299*x) - 33.0*pi*sin(2.82743338823081*x*y) -270.0*pi^2*cos(4.71238898038469*y)



fymom = -118.8*pi^2*x^2*cos(2.82743338823081*x*y) + 8.4*pi^2*x*y*cos(1.88495559215388*x*y) - 18750.0*pi*x*cos(2.35619449019234*x*y) - 89.1*pi^2*y^2*cos(2.82743338823081*x*y) + (19.8*pi*x*sin(2.82743338823081*x*y) + 8.0*pi*cos(3.14159265358979*y))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) + (-0.1*pi*x*sin(3.92699081698724*x*y) - 0.15*pi*sin(3.14159265358979*y))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0)^2 + (-4.2*pi*y*sin(1.88495559215388*x*y) + 6.66666666666667*pi*cos(5.23598775598299*x))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) +90.0) + (9.9*pi*y*sin(2.82743338823081*x*y) + 30.0*pi*sin(4.71238898038469*x))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0) + (-0.1*pi*y*sin(3.92699081698724*x*y) + 0.075*pi*cos(2.35619449019234*x))*(4.0*sin(5.23598775598299*x) -12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) +90.0) + 53.3333333333333*pi^2*sin(3.14159265358979*y) +14.0*pi*sin(1.88495559215388*x*y) - 450.0*pi^2*cos(4.71238898038469*x) + 25000.0*pi*cos(3.92699081698724*y)



fe = -(-4.2*pi*x*sin(1.88495559215388*x*y) + 18.0*pi*sin(4.71238898038469*y))*(-42.0*pi*x*sin(1.88495559215388*x*y)+ 99.0*pi*y*sin(2.82743338823081*x*y) + 300.0*pi*sin(4.71238898038469*x) + 180.0*pi*sin(4.71238898038469*y)) + (9.9*pi*x*sin(2.82743338823081*x*y) + 4.0*pi*cos(3.14159265358979*y))*((1.0/2.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0)^2 + (1.0/2.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) -11.0*cos(2.82743338823081*x*y) + 90.0)^2 + 2.5*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) +100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0) - (9.9*pi*x*sin(2.82743338823081*x*y) + 4.0*pi*cos(3.14159265358979*y))*(132.0*pi*x*sin(2.82743338823081*x*y)+ 28.0*pi*y*sin(1.88495559215388*x*y) - 44.4444444444444*pi*cos(5.23598775598299*x) + 53.3333333333333*pi*cos(3.14159265358979*y)) + (9.9*pi*x*sin(2.82743338823081*x*y)+ 4.0*pi*cos(3.14159265358979*y))*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) -30000.0*cos(3.14159265358979*x) + 100000.0) + (-0.1*pi*x*sin(3.92699081698724*x*y) - 0.15*pi*sin(3.14159265358979*y))*((1.0/2.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0)^2 + (1.0/2.0)*(4.0*sin(3.14159265358979*y) -20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0)^2 + 2.5*(20000.0*sin(3.92699081698724*y) -25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) + 100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) - 35.0*(0.1*pi*x*sin(3.92699081698724*x*y) + 0.15*pi*sin(3.14159265358979*y))*(0.2*pi*x*sin(3.92699081698724*x*y) + 0.3*pi*sin(3.14159265358979*y))*(20000.0*sin(3.92699081698724*y) -25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) + 100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)^3 - 70.0*(0.1*pi*x*sin(3.92699081698724*x*y) + 0.15*pi*sin(3.14159265358979*y))*(-18750.0*pi*x*cos(2.35619449019234*x*y) + 25000.0*pi*cos(3.92699081698724*y))/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)^2 + (-18750.0*pi*x*cos(2.35619449019234*x*y) +25000.0*pi*cos(3.92699081698724*y))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) + (-4.2*pi*y*sin(1.88495559215388*x*y) + 6.66666666666667*pi*cos(5.23598775598299*x))*((1.0/2.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0)^2 + (1.0/2.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) -11.0*cos(2.82743338823081*x*y) + 90.0)^2 + 2.5*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) +100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0) - (-4.2*pi*y*sin(1.88495559215388*x*y) +6.66666666666667*pi*cos(5.23598775598299*x))*(-66.0*pi*x*sin(2.82743338823081*x*y) - 56.0*pi*y*sin(1.88495559215388*x*y) + 88.8888888888889*pi*cos(5.23598775598299*x) -26.6666666666667*pi*cos(3.14159265358979*y)) + (-4.2*pi*y*sin(1.88495559215388*x*y) + 6.66666666666667*pi*cos(5.23598775598299*x))*(20000.0*sin(3.92699081698724*y) -25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) + 100000.0) - (9.9*pi*y*sin(2.82743338823081*x*y) + 30.0*pi*sin(4.71238898038469*x))*(-42.0*pi*x*sin(1.88495559215388*x*y) + 99.0*pi*y*sin(2.82743338823081*x*y) + 300.0*pi*sin(4.71238898038469*x) +180.0*pi*sin(4.71238898038469*y)) + (-0.1*pi*y*sin(3.92699081698724*x*y) + 0.075*pi*cos(2.35619449019234*x))*((1.0/2.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0)^2 + (1.0/2.0)*(4.0*sin(3.14159265358979*y) -20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0)^2 + 2.5*(20000.0*sin(3.92699081698724*y) -25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) + 100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0) - 35.0*(0.1*pi*y*sin(3.92699081698724*x*y) - 0.075*pi*cos(2.35619449019234*x))*(0.2*pi*y*sin(3.92699081698724*x*y) - 0.15*pi*cos(2.35619449019234*x))*(20000.0*sin(3.92699081698724*y) -25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) + 100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)^3 - 70.0*(0.1*pi*y*sin(3.92699081698724*x*y) - 0.075*pi*cos(2.35619449019234*x))*(-18750.0*pi*y*cos(2.35619449019234*x*y) + 30000.0*pi*sin(3.14159265358979*x))/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)^2 + (-18750.0*pi*y*cos(2.35619449019234*x*y) +30000.0*pi*sin(3.14159265358979*x))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0) - 35.0*(14062.5*pi^2*x^2*sin(2.35619449019234*x*y) - 31250.0*pi^2*sin(3.92699081698724*y))/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0) - 35.0*(0.125*pi^2*x^2*cos(3.92699081698724*x*y) +0.15*pi^2*cos(3.14159265358979*y))*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) -30000.0*cos(3.14159265358979*x) + 100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)^2 - 35.0*(14062.5*pi^2*y^2*sin(2.35619449019234*x*y) + 30000.0*pi^2*cos(3.14159265358979*x))/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0) - 35.0*(0.125*pi^2*y^2*cos(3.92699081698724*x*y) +0.05625*pi^2*sin(2.35619449019234*x))*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) -30000.0*cos(3.14159265358979*x) + 100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)^2 + ((1.0/2.0)*(-8.4*pi*x*sin(1.88495559215388*x*y) + 36.0*pi*sin(4.71238898038469*y))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0) + (1.0/2.0)*(19.8*pi*x*sin(2.82743338823081*x*y)+ 8.0*pi*cos(3.14159265358979*y))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) + 2.5*(0.1*pi*x*sin(3.92699081698724*x*y) + 0.15*pi*sin(3.14159265358979*y))*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) +100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)^2 + 2.5*(-18750.0*pi*x*cos(2.35619449019234*x*y) +25000.0*pi*cos(3.92699081698724*y))/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) + ((1.0/2.0)*(-8.4*pi*y*sin(1.88495559215388*x*y) + 13.3333333333333*pi*cos(5.23598775598299*x))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0) + (1.0/2.0)*(19.8*pi*y*sin(2.82743338823081*x*y)+ 60.0*pi*sin(4.71238898038469*x))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) + 2.5*(0.1*pi*y*sin(3.92699081698724*x*y) - 0.075*pi*cos(2.35619449019234*x))*(20000.0*sin(3.92699081698724*y) - 25000.0*sin(2.35619449019234*x*y) - 30000.0*cos(3.14159265358979*x) +100000.0)/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) +1.0)^2 + 2.5*(-18750.0*pi*y*cos(2.35619449019234*x*y) +30000.0*pi*sin(3.14159265358979*x))/(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0))*(0.1*sin(2.35619449019234*x) + 0.15*cos(3.14159265358979*y) + 0.08*cos(3.92699081698724*x*y) + 1.0)*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) + 70.0) - (-25.2*pi^2*x^2*cos(1.88495559215388*x*y) + 89.1*pi^2*x*y*cos(2.82743338823081*x*y) + 99.0*pi*sin(2.82743338823081*x*y) + 270.0*pi^2*cos(4.71238898038469*y))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0) - (118.8*pi^2*x^2*cos(2.82743338823081*x*y) +16.8*pi^2*x*y*cos(1.88495559215388*x*y) - 53.3333333333333*pi^2*sin(3.14159265358979*y) + 28.0*pi*sin(1.88495559215388*x*y))*(4.0*sin(3.14159265358979*y) -20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) + 90.0) - (-25.2*pi^2*x*y*cos(1.88495559215388*x*y) +89.1*pi^2*y^2*cos(2.82743338823081*x*y) - 42.0*pi*sin(1.88495559215388*x*y) + 450.0*pi^2*cos(4.71238898038469*x))*(4.0*sin(3.14159265358979*y) - 20.0*cos(4.71238898038469*x) - 11.0*cos(2.82743338823081*x*y) +90.0) - (-59.4*pi^2*x*y*cos(2.82743338823081*x*y) - 33.6*pi^2*y^2*cos(1.88495559215388*x*y) - 148.148148148148*pi^2*sin(5.23598775598299*x) - 66.0*pi*sin(2.82743338823081*x*y))*(4.0*sin(5.23598775598299*x) - 12.0*cos(4.71238898038469*y) + 7.0*cos(1.88495559215388*x*y) +70.0)



   src.mass = fmass
   src.momentum_x = fxmom
   src.momentum_y = fymom
   src.momentum_z = 0.0
   src.total_energy = fe
   src.species = {src.mass}
   return src
end
